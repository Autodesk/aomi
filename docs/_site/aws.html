<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" href="/aomi/assets/css/style.css?v=">
    <title>aomi by Autodesk</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>aomi</h1>
        <h2>Opinionlessly Express Opinions on Vault</h2>

        <section id="downloads">
          
          <a href="https://github.com/Autodesk/aomi" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1 id="overview">Overview</h1>

<p>The aomi tool is able to write to the AWS backend of Vault.</p>

<h1 id="format">Format</h1>

<p>By specifying an appropriately populated <code class="highlighter-rouge">aws_file</code> you can create <a href="https://www.vaultproject.io/docs/secrets/aws/index.html">AWS secret backends</a> in Vault. The <code class="highlighter-rouge">aws_file</code> must point to a valid file, and the base of the AWS credentials will be set by the <code class="highlighter-rouge">mount</code>.</p>

<p>The AWS file contains the <code class="highlighter-rouge">access_key_id</code>, and <code class="highlighter-rouge">secret_access_key</code>. The <code class="highlighter-rouge">region</code>, and a list of AWS roles that will be loaded by Vault are in the <code class="highlighter-rouge">Secretfile</code>. Note that you may specify either an inline <code class="highlighter-rouge">policy</code> <em>or</em> a native AWS <code class="highlighter-rouge">arn</code>. The <code class="highlighter-rouge">name</code> of each role will be used to compute the final path for accessing credentials. The policy files are simply JSON IAM Access representations. The following example would create an AWS Vault secret backend at <code class="highlighter-rouge">foo/bar/baz</code> based on the account and policy information defined in <code class="highlighter-rouge">.secrets/aws.yml</code>. While <code class="highlighter-rouge">lease</code> and <code class="highlighter-rouge">lease_max</code> are provided in this example, they are not strictly required. Note that you can also specify a <code class="highlighter-rouge">state</code> as either <code class="highlighter-rouge">present</code> (the default) or <code class="highlighter-rouge">absent</code>.</p>

<p>Note that a previous version had <code class="highlighter-rouge">lease</code>, <code class="highlighter-rouge">lease_max</code>, <code class="highlighter-rouge">region</code>, and the <code class="highlighter-rouge">roles</code> section located in the <code class="highlighter-rouge">aws_file</code> itself - this behavior is now considered deprecated. The <em>only</em> thing which should be present in the AWS yaml is the actual secrets.</p>

<hr />

<p><code class="highlighter-rouge">Secretfile</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code>secrets:
- aws_file: 'aws.yml'
  mount: 'foo/bar/baz'
  lease: "1800s"
  lease_max: "86400s"
  region: "us-east-1"
  roles:
  - policy: "policy.json"
    name: default
</code></pre>
</div>

<hr />

<p><code class="highlighter-rouge">aws.yml</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code>
access_key_id: "REDACTED"
secret_access_key: "REDACTED"
</code></pre>
</div>


      </section>
    </div>

    
  </body>
</html>
